# v2.0.1.1

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**2.0.1.1**] - 2026-02-14

**Command Dispatch Security Fix + Style Alignment (Spec 118)** — Fixed phantom dispatch vulnerability across all **7 spec_kit command files**, added imperative guardrails and REFERENCE comments to **11 YAML workflow files**, aligned **112 H2 headers** with emoji standards, plus AGENTS.md audit fixes and repository cleanup.

> Spec folder: `anobel.com/.opencode/specs/003-system-spec-kit/118-fix-command-dispatch/` (Level 3+, 5 ADRs)

---

### Changed

**Security Fix — Command Dispatch Vulnerability (Spec 118):**

OpenCode's Go runtime was injecting phantom dispatch instructions into command files based on `@agent` references combined with `allowed-tools: Task` in frontmatter. The injected text existed nowhere in the codebase — confirmed via exhaustive grep — yet agents were dispatching directly instead of loading YAML workflows.

**What changed:**

- **Imperative guardrail blocks**: Added lines 7-18 to all 7 command files with explicit `DO NOT dispatch agents directly` instruction, creating a hard stop before any phantom dispatch text could be processed
- **YAML loading instructions at top**: Moved the actual "load YAML and execute" instruction from lines 140-183 to the top of each command file, ensuring it's the first substantive instruction the LLM processes
- **Fenced unfenced dispatch templates**: 4 command files (complete, debug, research, plan) had raw dispatch template text that could be interpreted as live instructions. Wrapped in explicit code fences with `REFERENCE ONLY` labels
- **@agent reference density reduction**: `complete.md` reduced from 19 to 9 @agent references, `debug.md` from 15 to 9, lowering the probability of phantom dispatch text injection
- **YAML REFERENCE comments**: Added 30 `# REFERENCE ONLY` comments across 11 YAML workflow asset files, clarifying that agent references in YAML are routing metadata, not dispatch instructions

**Style Alignment:**

- **H2 emoji headers**: Added emojis to all 112 H2 headers across 7 command files, aligning with `workflows-documentation` style standards
- **Decimal step renumbering**: Renumbered `## 7.5` to `## 8.` in `plan.md` (with subsequent sections renumbered), eliminating non-standard decimal step numbering

---

### Fixed

**AGENTS.md Audit Fixes:**

- **skill_advisor.py phantom references (B2)**: Fixed references to 2 removed skills (`mcp-narsil`, `mcp-browser`) that caused skill routing failures
- **Template paths and skill table (B3)**: Corrected stale template paths in §9 and added 4 missing skills to the Available Skills table

**Repository Cleanup:**

- **Specs removed from tracking**: All spec folders removed from git tracking (kept on disk, added to `.gitignore`), reducing repo size for public consumers
- **`.agents/` symlinks**: Added `.agents/` directory with symlinks to `.opencode/agent/` and `.opencode/command/` for user convenience
- **README table sorting**: Sorted README tables by importance across scripts and install_guides directories

---

**Files:** 7 command `.md` files in `.opencode/command/spec_kit/` · 11 YAML assets in `.opencode/command/spec_kit/assets/` · `AGENTS.md` · `.gitignore` · `.agents/` (symlinks)

**Full Changelog**: https://github.com/MichelKerkmeester/opencode-spec-kit-framework/compare/v2.0.1.0...v2.0.1.1

---

*For full release history, see the [global CHANGELOG](../CHANGELOG.md).*
