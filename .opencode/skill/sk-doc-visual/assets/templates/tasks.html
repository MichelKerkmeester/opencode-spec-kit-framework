<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <meta name="ve-artifact-type" content="tasks">
    <meta name="ve-source-doc" content="">
    <meta name="ve-speckit-level" content="3">
    <meta name="ve-view-mode" content="artifact-dashboard">
    <title>Task Breakdown | SpecKit</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({ startOnLoad: true, theme: 'dark' });</script>
    <style>
        :root {
    --font-from-0: 14; --font-to-0: 18;
    --vw-from-0: calc(1 / 100); --vw-to-0: calc(991 / 100);
    --coefficient-0: calc((var(--font-to-0) - var(--font-from-0)) / (var(--vw-to-0) - var(--vw-from-0)));
    --base-0: calc((var(--font-from-0) - var(--vw-from-0) * var(--coefficient-0)) / 16);

    --font-from-1: 14; --font-to-1: 18;
    --vw-from-1: calc(991 / 100); --vw-to-1: calc(1440 / 100);
    --coefficient-1: calc((var(--font-to-1) - var(--font-from-1)) / (var(--vw-to-1) - var(--vw-from-1)));
    --base-1: calc((var(--font-from-1) - var(--vw-from-1) * var(--coefficient-1)) / 16);

    --font-from-2: 14; --font-to-2: 16;
    --vw-from-2: calc(1440 / 100); --vw-to-2: calc(1920 / 100);
    --coefficient-2: calc((var(--font-to-2) - var(--font-from-2)) / (var(--vw-to-2) - var(--vw-from-2)));
    --base-2: calc((var(--font-from-2) - var(--vw-from-2) * var(--coefficient-2)) / 16);

    --font-from-3: 17; --font-to-3: 24;
    --vw-from-3: calc(1920 / 100); --vw-to-3: calc(5120 / 100);
    --coefficient-3: calc((var(--font-to-3) - var(--font-from-3)) / (var(--vw-to-3) - var(--vw-from-3)));
    --base-3: calc((var(--font-from-3) - var(--vw-from-3) * var(--coefficient-3)) / 16);

    --font-size-4: 1.5;
}

        html {
    font-size: calc(var(--font-size-4) * 1rem);
}

        @media queries below to adjust the base html font-size.
*/

:root {
    --font-from-0: 14; --font-to-0: 18;
    --vw-from-0: calc(1 / 100); --vw-to-0: calc(991 / 100);
    --coefficient-0: calc((var(--font-to-0) - var(--font-from-0)) / (var(--vw-to-0) - var(--vw-from-0)));
    --base-0: calc((var(--font-from-0) - var(--vw-from-0) * var(--coefficient-0)) / 16);

    --font-from-1: 14; --font-to-1: 18;
    --vw-from-1: calc(991 / 100); --vw-to-1: calc(1440 / 100);
    --coefficient-1: calc((var(--font-to-1) - var(--font-from-1)) / (var(--vw-to-1) - var(--vw-from-1)));
    --base-1: calc((var(--font-from-1) - var(--vw-from-1) * var(--coefficient-1)) / 16);

    --font-from-2: 14; --font-to-2: 16;
    --vw-from-2: calc(1440 / 100); --vw-to-2: calc(1920 / 100);
    --coefficient-2: calc((var(--font-to-2) - var(--font-from-2)) / (var(--vw-to-2) - var(--vw-from-2)));
    --base-2: calc((var(--font-from-2) - var(--vw-from-2) * var(--coefficient-2)) / 16);

    --font-from-3: 17; --font-to-3: 24;
    --vw-from-3: calc(1920 / 100); --vw-to-3: calc(5120 / 100);
    --coefficient-3: calc((var(--font-to-3) - var(--font-from-3)) / (var(--vw-to-3) - var(--vw-from-3)));
    --base-3: calc((var(--font-from-3) - var(--vw-from-3) * var(--coefficient-3)) / 16);

    --font-size-4: 1.5;
}
@media screen and (max-width: 5120px) { html { font-size: calc(var(--base-3) * 1rem + var(--coefficient-3) * 1vw); }
@media screen and (max-width: 1920px) { html { font-size: calc(var(--base-2) * 1rem + var(--coefficient-2) * 1vw); }
@media screen and (max-width: 1440px) { html { font-size: calc(var(--base-1) * 1rem + var(--coefficient-1) * 1vw); }
@media screen and (max-width: 991px)  { html { font-size: calc(var(--base-0) * 1rem + var(--coefficient-0) * 1vw); }

        body {
            font-family: 'Helvetica', sans-serif;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent); }

        .page-container { width: 100%; max-width: 90rem; margin: 0 auto; }

        .main-grid {
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 4rem;
        }

        .toc-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--muted);
            padding: 0.4rem 0;
            transition: all 0.2s ease;
            letter-spacing: 0.05em;
        }
        .toc-link:hover { color: var(--text); }
        .toc-link.active { color: var(--accent); }
        .toc-link.active::before {
            content: '';
            width: 4px;
            height: 4px;
            background: var(--accent);
            border-radius: 50%;
        }

        .terminal-header {
            border-bottom: 1px solid var(--border);
            background: rgba(19, 19, 20, 0.95);
            backdrop-filter: blur(12px);
            z-index: 100;
        }

        .ledger-line {
            height: 1px;
            background: linear-gradient(90deg, var(--border) 0%, transparent 100%);
            margin: 2rem 0;
        }

        .reveal {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.22, 1, 0.36, 1);
        }
        .reveal.active { opacity: 1; transform: translateY(0); }

        .glass-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            transition: border-color 0.3s ease;
        }
        .glass-card:hover { border-color: var(--accent); }

        .scanline {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 2px;
            background: rgba(59, 130, 246, 0.05);
            opacity: 0.5;
            z-index: 200;
            pointer-events: none;
            animation: scan 10s linear infinite;
        }
        @keyframes scan { 0% { top: -2%; } 100% { top: 100%; } }

        .inline-code {
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent);
            font-size: 0.9em;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.1rem 0.3rem;
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        .viz-bar {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
        }
        .viz-fill {
            height: 100%;
            width: 0;
            border-radius: 3px;
            transition: width 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .kpi-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }
        

        .task-card {
            border-left: 3px solid var(--border);
            transition: transform 0.2s ease, border-color 0.3s ease;
        }
        .task-card:hover { transform: translateX(4px); }
        .task-card.completed { border-left-color: var(--success); }
        .task-card.pending { border-left-color: var(--muted); }
        .task-card.in-progress { border-left-color: var(--warning); }
        .task-card.blocked { border-left-color: var(--danger); }

        .status {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 600;
            letter-spacing: 0.05em;
        }
        .status.completed { background: rgba(34, 197, 94, 0.1); color: var(--success); }
        .status.pending { background: rgba(249, 115, 22, 0.1); color: var(--accent); }
        .status.in-progress { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .status.blocked { background: rgba(239, 68, 68, 0.1); color: var(--danger); }

        details summary { cursor: pointer; list-style: none; }
        details summary::-webkit-details-marker { display: none; }
        details summary .chevron { transition: transform 0.3s ease; }
        details[open] summary .chevron { transform: rotate(90deg); }

        @keyframes pulse-amber {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-amber { animation: pulse-amber 2s ease-in-out infinite; }

        
    </style>
</head>
<body>
    <div class="selection:bg-blue-500/30 min-h-screen relative w-full">
        <div class="scanline"></div>

        <!-- Status Bar -->
        <div class="terminal-header sticky top-0 px-6 py-3 flex items-center justify-between text-[10px] font-semibold tracking-widest text-muted mono">
            <div class="flex items-center gap-6">
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                    <span class="text-text">Tasks Active</span>
                </div>
                <div class="hidden md:block">Spec: 142-search-pipeline-v3</div>
                <div class="hidden md:block">Phase: 3 of 4</div>
            </div>
            <div class="flex items-center gap-6">
                <div id="clock">00:00:00 UTC</div>
                <div class="text-accent">Progress: 12/18 Complete</div>
            </div>
        </div>

        <div class="page-container px-6 lg:px-12 py-12">

            <!-- Hero Header -->
            <header class="mb-24 reveal" id="top">
                <div class="flex flex-col lg:flex-row lg:items-end justify-between gap-12">
                    <div class="space-y-6">
                        <div class="inline-flex items-center gap-2 px-3 py-1 border border-blue-500/20 bg-blue-500/5 text-blue-400 text-[10px] font-semibold tracking-widest rounded">
                            142-search-pipeline-v3 // ContextType: Tasks
                        </div>
                        <h1 class="text-7xl md:text-9xl font-semibold tracking-tighter leading-none">
                            Task<br><span class="text-accent">Breakdown.</span>
                        </h1>
                    </div>
                    <div class="lg:text-right space-y-6">
                        <div class="space-y-1">
                            <p class="text-[10px] text-muted font-semibold tracking-widest">Overall Completion</p>
                            <p class="text-5xl font-semibold mono text-accent">67%</p>
                        </div>
                        <div class="space-y-2 lg:ml-auto" style="max-width: 240px;">
                            <div class="flex justify-between text-[10px] mono text-muted">
                                <span>12 / 18 tasks</span>
                                <span>In Progress</span>
                            </div>
                            <div class="viz-bar" style="height: 8px;">
                                <div class="viz-fill" data-width="67%" style="background: linear-gradient(90deg, var(--accent), var(--warning));"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ledger-line"></div>
            </header>

            <div class="main-grid">

                <!-- Sidebar TOC -->
                <aside class="sidebar">
                    <nav class="sticky top-24 space-y-12">
                        <div class="space-y-4">
                            <p class="text-[10px] font-semibold tracking-[0.2em] text-muted">Task Ledger</p>
                            <div id="sidebar-nav" class="flex flex-col gap-1">
                                <a href="#legend" id="nav-legend" class="toc-link active">00 Legend</a>
                                <a href="#overview" id="nav-overview" class="toc-link">01 Overview</a>
                                <a href="#phase-1" id="nav-phase-1" class="toc-link">02 Phase 1</a>
                                <a href="#phase-2" id="nav-phase-2" class="toc-link">03 Phase 2</a>
                                <a href="#phase-3" id="nav-phase-3" class="toc-link">04 Phase 3</a>
                                <a href="#phase-4" id="nav-phase-4" class="toc-link">05 Phase 4</a>
                                <a href="#criteria" id="nav-criteria" class="toc-link">06 Criteria</a>
                                <a href="#cross-refs" id="nav-cross-refs" class="toc-link">07 References</a>
                            </div>
                        </div>
                    </nav>
                </aside>

                <!-- Content Area -->
                <main class="space-y-[clamp(4rem,10vh,8rem)]">

                    <!-- 00 Task Notation Legend -->
                    <section id="legend" class="space-y-8 reveal">
                        <h2 class="text-[10px] text-text tracking-[0.3em] font-semibold opacity-80 border-b border-[rgba(255,255,255,0.08)] pb-4">00 // Task Notation Legend</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="glass-card p-4 flex items-center gap-3">
                                <iconify-icon icon="lucide:circle" class="text-lg text-muted"></iconify-icon>
                                <div>
                                    <p class="text-xs font-semibold">Pending</p>
                                    <p class="text-[10px] text-muted">Not yet started</p>
                                </div>
                            </div>
                            <div class="glass-card p-4 flex items-center gap-3">
                                <iconify-icon icon="lucide:check-circle" class="text-lg text-green-500"></iconify-icon>
                                <div>
                                    <p class="text-xs font-semibold">Completed</p>
                                    <p class="text-[10px] text-muted">Verified done</p>
                                </div>
                            </div>
                            <div class="glass-card p-4 flex items-center gap-3">
                                <iconify-icon icon="lucide:chevrons-right" class="text-lg text-accent"></iconify-icon>
                                <div>
                                    <p class="text-xs font-semibold">Parallelizable</p>
                                    <p class="text-[10px] text-muted">Can run concurrently</p>
                                </div>
                            </div>
                            <div class="glass-card p-4 flex items-center gap-3">
                                <iconify-icon icon="lucide:lock" class="text-lg text-red-500"></iconify-icon>
                                <div>
                                    <p class="text-xs font-semibold">Blocked</p>
                                    <p class="text-[10px] text-muted">Dependency unmet</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 01 Overview KPIs -->
                    <section id="overview" class="space-y-8 reveal">
                        <h2 class="text-[10px] text-accent tracking-[0.3em] font-semibold border-b border-[rgba(255,255,255,0.08)] pb-4">01 // Overview</h2>
                        <div class="kpi-row">
                            <div class="glass-card p-5 space-y-2">
                                <p class="text-[10px] text-muted font-semibold tracking-widest">TOTAL TASKS</p>
                                <p class="text-4xl font-semibold mono">18</p>
                                <p class="text-[10px] text-muted">across 4 phases</p>
                            </div>
                            <div class="glass-card p-5 space-y-2">
                                <p class="text-[10px] font-semibold tracking-widest text-green-500">COMPLETED</p>
                                <p class="text-4xl font-semibold mono text-green-500">12</p>
                                <p class="text-[10px] text-muted">verified with evidence</p>
                            </div>
                            <div class="glass-card p-5 space-y-2">
                                <p class="text-[10px] font-semibold tracking-widest text-amber-500">IN PROGRESS</p>
                                <p class="text-4xl font-semibold mono text-amber-500">4</p>
                                <p class="text-[10px] text-muted">actively being worked</p>
                            </div>
                            <div class="glass-card p-5 space-y-2">
                                <p class="text-[10px] font-semibold tracking-widest text-red-500">BLOCKED</p>
                                <p class="text-4xl font-semibold mono text-red-500">2</p>
                                <p class="text-[10px] text-muted">awaiting dependencies</p>
                            </div>
                        </div>
                    </section>

                    <!-- 02 Phase 1 — Evidence Collection -->
                    <section id="phase-1" class="space-y-6 reveal">
                        <details open>
                            <summary class="flex items-center justify-between cursor-pointer group">
                                <div class="flex items-center gap-4">
                                    <iconify-icon icon="lucide:chevron-right" class="chevron text-muted text-sm"></iconify-icon>
                                    <h2 class="text-[10px] text-text tracking-[0.3em] font-semibold opacity-80">02 // Phase 1 — Evidence Collection</h2>
                                    <span class="status completed">5/5 COMPLETE</span>
                                </div>
                                <div class="w-32 hidden md:block">
                                    <div class="viz-bar">
                                        <div class="viz-fill bg-green-500" data-width="100%"></div>
                                    </div>
                                </div>
                            </summary>
                            <div class="mt-6 space-y-3">
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T001</span>
                                            <span class="text-sm font-semibold">Audit existing search handlers for instrumentation gaps</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Scan all handler files for missing telemetry hooks. Document coverage baseline.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/handlers/memory-search.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T002</span>
                                            <span class="text-sm font-semibold">Catalog artifact types from spec folder corpus</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Build type registry from actual document patterns. Identify classification heuristics.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/artifact-classifier.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T003</span>
                                            <span class="text-sm font-semibold">Profile vector search latency under production load</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Capture p50/p95/p99 timings across 500-memory and 2000-memory databases.</p>
                                        <p class="mono text-[10px] text-muted">benchmarks/search-latency.bench.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T004</span>
                                            <iconify-icon icon="lucide:chevrons-right" class="text-xs text-accent"></iconify-icon>
                                            <span class="text-sm font-semibold">Map intent-detection accuracy on labeled query set</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Run 200 labeled queries through intent classifier. Measure precision/recall per intent type.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/intent-classifier.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T005</span>
                                            <span class="text-sm font-semibold">Document current fusion weight configuration</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Extract and formalize all hardcoded weight values into a configuration schema.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/fusion-weights.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                            </div>
                        </details>
                    </section>

                    <!-- 03 Phase 2 — Cleanup Documentation -->
                    <section id="phase-2" class="space-y-6 reveal">
                        <details open>
                            <summary class="flex items-center justify-between cursor-pointer group">
                                <div class="flex items-center gap-4">
                                    <iconify-icon icon="lucide:chevron-right" class="chevron text-muted text-sm"></iconify-icon>
                                    <h2 class="text-[10px] text-text tracking-[0.3em] font-semibold opacity-80">03 // Phase 2 — Cleanup Documentation</h2>
                                    <span class="status completed">4/4 COMPLETE</span>
                                </div>
                                <div class="w-32 hidden md:block">
                                    <div class="viz-bar">
                                        <div class="viz-fill bg-green-500" data-width="100%"></div>
                                    </div>
                                </div>
                            </summary>
                            <div class="mt-6 space-y-3">
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T006</span>
                                            <span class="text-sm font-semibold">Remove deprecated embedding provider interfaces</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Delete legacy provider code paths and migrate all references to unified embedding service.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/embeddings/providers/</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T007</span>
                                            <iconify-icon icon="lucide:chevrons-right" class="text-xs text-accent"></iconify-icon>
                                            <span class="text-sm font-semibold">Consolidate duplicate search utility functions</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Merge overlapping helper functions in hybrid-search and vector-search modules.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/search-utils.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T008</span>
                                            <span class="text-sm font-semibold">Archive stale feature flag definitions</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Identify flags with 100% rollout for over 30 days and remove from runtime config.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/search-flags.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T009</span>
                                            <span class="text-sm font-semibold">Update JSDoc annotations across search modules</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Align inline documentation with current API contracts and parameter shapes.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/*.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                            </div>
                        </details>
                    </section>

                    <!-- 04 Phase 3 — Artifact Authoring -->
                    <section id="phase-3" class="space-y-6 reveal">
                        <details open>
                            <summary class="flex items-center justify-between cursor-pointer group">
                                <div class="flex items-center gap-4">
                                    <iconify-icon icon="lucide:chevron-right" class="chevron text-muted text-sm"></iconify-icon>
                                    <h2 class="text-[10px] text-text tracking-[0.3em] font-semibold opacity-80">04 // Phase 3 — Artifact Authoring</h2>
                                    <span class="status in-progress">4/6 COMPLETE</span>
                                </div>
                                <div class="w-32 hidden md:block">
                                    <div class="viz-bar">
                                        <div class="viz-fill bg-amber-500" data-width="67%"></div>
                                    </div>
                                </div>
                            </summary>
                            <div class="mt-6 space-y-3">
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T010</span>
                                            <span class="text-sm font-semibold">Write ContextEnvelope type definitions</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Define TypeScript interfaces for the retrieval trace envelope with full provenance chain.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/types/context-envelope.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T011</span>
                                            <iconify-icon icon="lucide:chevrons-right" class="text-xs text-accent"></iconify-icon>
                                            <span class="text-sm font-semibold">Implement artifact-type routing matrix</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Build the 9-type artifact classifier with per-type search strategy configuration.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/artifact-router.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T012</span>
                                            <span class="text-sm font-semibold">Build adaptive fusion weight calculator</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Implement dynamic weight adjustment based on detected query intent for 7 task types.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/search/adaptive-fusion.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T013</span>
                                            <span class="text-sm font-semibold">Create append-only mutation ledger schema</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Design and migrate the tamper-proof audit table with database-level insert-only constraints.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/database/migrations/009-mutation-ledger.sql</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card pending p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:circle" class="text-lg mt-0.5 text-muted"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T014</span>
                                            <span class="text-sm font-semibold">Wire extended telemetry emitters into search handlers</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Instrument all search code paths with timing, strategy, resilience, and quality metrics.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/handlers/memory-search.ts</p>
                                    </div>
                                    <span class="status pending">Pending</span>
                                </div>
                                <div class="glass-card task-card pending p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:circle" class="text-lg mt-0.5 text-muted"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T015</span>
                                            <iconify-icon icon="lucide:chevrons-right" class="text-xs text-accent"></iconify-icon>
                                            <span class="text-sm font-semibold">Author Zod schemas for configuration validation</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Replace loose config parsing with strict runtime schema validation across all search settings.</p>
                                        <p class="mono text-[10px] text-muted">mcp_server/lib/config/search-config.schema.ts</p>
                                    </div>
                                    <span class="status pending">Pending</span>
                                </div>
                            </div>
                        </details>
                    </section>

                    <!-- 05 Phase 4 — Validation -->
                    <section id="phase-4" class="space-y-6 reveal">
                        <details open>
                            <summary class="flex items-center justify-between cursor-pointer group">
                                <div class="flex items-center gap-4">
                                    <iconify-icon icon="lucide:chevron-right" class="chevron text-muted text-sm"></iconify-icon>
                                    <h2 class="text-[10px] text-text tracking-[0.3em] font-semibold opacity-80">05 // Phase 4 — Validation</h2>
                                    <span class="status blocked">1/3 COMPLETE</span>
                                </div>
                                <div class="w-32 hidden md:block">
                                    <div class="viz-bar">
                                        <div class="viz-fill bg-red-500" data-width="33%"></div>
                                    </div>
                                </div>
                            </summary>
                            <div class="mt-6 space-y-3">
                                <div class="glass-card task-card completed p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:check-circle" class="text-lg mt-0.5 text-green-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T016</span>
                                            <span class="text-sm font-semibold">Rewrite embedding test suite from placeholders to real assertions</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Replace placeholder stubs with deterministic tests. Cover all provider paths and error cases.</p>
                                        <p class="mono text-[10px] text-muted">tests/embeddings.vitest.ts</p>
                                    </div>
                                    <span class="status completed">Done</span>
                                </div>
                                <div class="glass-card task-card in-progress p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:loader-2" class="text-lg mt-0.5 pulse-amber text-amber-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T017</span>
                                            <span class="text-sm font-semibold">Run full regression suite against search pipeline changes</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Execute complete test matrix including API validation, lazy loading, and integration scenarios.</p>
                                        <p class="mono text-[10px] text-muted">tests/search-regression.vitest.ts</p>
                                    </div>
                                    <span class="status in-progress">In Progress</span>
                                </div>
                                <div class="glass-card task-card blocked p-5 flex items-start gap-4">
                                    <iconify-icon icon="lucide:lock" class="text-lg mt-0.5 text-red-500"></iconify-icon>
                                    <div class="flex-1 space-y-1">
                                        <div class="flex items-center gap-3">
                                            <span class="mono text-xs font-semibold text-accent">T018</span>
                                            <span class="text-sm font-semibold">Verify mutation ledger tamper-proof constraints under concurrent writes</span>
                                        </div>
                                        <p class="text-[11px] text-muted leading-relaxed">Stress test the append-only ledger with parallel mutation attempts and verify rejection of updates/deletes.</p>
                                        <p class="mono text-[10px] text-muted">tests/mutation-ledger.stress.ts</p>
                                        <div class="mt-2 p-2 bg-red-500/5 border border-red-500/20 rounded text-[10px] text-red-500">
                                            <iconify-icon icon="lucide:alert-triangle" class="text-xs"></iconify-icon>
                                            Blocked by: T014 (telemetry emitters) and T017 (regression suite must pass first)
                                        </div>
                                    </div>
                                    <span class="status blocked">Blocked</span>
                                </div>
                            </div>
                        </details>
                    </section>

                    <!-- 06 Completion Criteria -->
                    <section id="criteria" class="space-y-8 reveal">
                        <h2 class="text-[10px] text-accent tracking-[0.3em] font-semibold border-b border-[rgba(255,255,255,0.08)] pb-4">06 // Completion Criteria</h2>
                        <div class="glass-card p-6 space-y-4">
                            <div class="flex items-center gap-3 text-sm">
                                <iconify-icon icon="lucide:check-circle" class="text-green-500"></iconify-icon>
                                <span>All Phase 1 evidence artifacts collected and reviewed</span>
                            </div>
                            <div class="flex items-center gap-3 text-sm">
                                <iconify-icon icon="lucide:check-circle" class="text-green-500"></iconify-icon>
                                <span>Deprecated code paths removed with zero import references remaining</span>
                            </div>
                            <div class="flex items-center gap-3 text-sm">
                                <iconify-icon icon="lucide:check-circle" class="text-green-500"></iconify-icon>
                                <span>ContextEnvelope type definitions pass strict TypeScript compilation</span>
                            </div>
                            <div class="flex items-center gap-3 text-sm">
                                <iconify-icon icon="lucide:circle" class="text-muted"></iconify-icon>
                                <span class="text-muted">Extended telemetry emitters integrated and verified in staging</span>
                            </div>
                            <div class="flex items-center gap-3 text-sm">
                                <iconify-icon icon="lucide:circle" class="text-muted"></iconify-icon>
                                <span class="text-muted">Full regression suite passing with zero failures</span>
                            </div>
                            <div class="flex items-center gap-3 text-sm">
                                <iconify-icon icon="lucide:circle" class="text-muted"></iconify-icon>
                                <span class="text-muted">Mutation ledger stress test confirms tamper-proof guarantees</span>
                            </div>
                            <div class="ledger-line"></div>
                            <div class="flex items-center justify-between text-[10px] mono text-muted">
                                <span>Criteria met: 3 / 6</span>
                                <div class="w-32">
                                    <div class="viz-bar">
                                        <div class="viz-fill bg-amber-500" data-width="50%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 07 Cross-References -->
                    <section id="cross-refs" class="space-y-8 reveal">
                        <h2 class="text-[10px] text-accent tracking-[0.3em] font-semibold border-b border-[rgba(255,255,255,0.08)] pb-4">07 // Cross-References</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <a href="#" class="glass-card p-5 flex items-center gap-4 group no-underline">
                                <iconify-icon icon="lucide:file-text" class="text-xl text-muted group-hover:text-accent transition-colors"></iconify-icon>
                                <div>
                                    <p class="text-sm font-semibold group-hover:text-accent transition-colors">spec.md</p>
                                    <p class="text-[10px] text-muted">Feature specification and scope definition</p>
                                </div>
                            </a>
                            <a href="#" class="glass-card p-5 flex items-center gap-4 group no-underline">
                                <iconify-icon icon="lucide:git-branch" class="text-xl text-muted group-hover:text-accent transition-colors"></iconify-icon>
                                <div>
                                    <p class="text-sm font-semibold group-hover:text-accent transition-colors">plan.md</p>
                                    <p class="text-[10px] text-muted">Implementation plan and phasing strategy</p>
                                </div>
                            </a>
                            <a href="#" class="glass-card p-5 flex items-center gap-4 group no-underline">
                                <iconify-icon icon="lucide:clipboard-check" class="text-xl text-muted group-hover:text-accent transition-colors"></iconify-icon>
                                <div>
                                    <p class="text-sm font-semibold group-hover:text-accent transition-colors">checklist.md</p>
                                    <p class="text-[10px] text-muted">QA verification checklist (P0/P1/P2 items)</p>
                                </div>
                            </a>
                            <a href="#" class="glass-card p-5 flex items-center gap-4 group no-underline">
                                <iconify-icon icon="lucide:scale" class="text-xl text-muted group-hover:text-accent transition-colors"></iconify-icon>
                                <div>
                                    <p class="text-sm font-semibold group-hover:text-accent transition-colors">decision-record.md</p>
                                    <p class="text-[10px] text-muted">Architecture decisions and trade-off rationale</p>
                                </div>
                            </a>
                            <a href="#" class="glass-card p-5 flex items-center gap-4 group no-underline">
                                <iconify-icon icon="lucide:microscope" class="text-xl text-muted group-hover:text-accent transition-colors"></iconify-icon>
                                <div>
                                    <p class="text-sm font-semibold group-hover:text-accent transition-colors">research.md</p>
                                    <p class="text-[10px] text-muted">Prior art research and benchmark analysis</p>
                                </div>
                            </a>
                            <a href="#" class="glass-card p-5 flex items-center gap-4 group no-underline">
                                <iconify-icon icon="lucide:package" class="text-xl text-muted group-hover:text-accent transition-colors"></iconify-icon>
                                <div>
                                    <p class="text-sm font-semibold group-hover:text-accent transition-colors">implementation-summary.md</p>
                                    <p class="text-[10px] text-muted">Post-implementation delivery summary</p>
                                </div>
                            </a>
                        </div>
                    </section>

                    <!-- Footer -->
                    <footer class="pt-24 border-t border-[rgba(255,255,255,0.08)] flex flex-col md:flex-row justify-between items-start md:items-center gap-8 opacity-40 mb-12">
                        <div class="space-y-1">
                            <p class="text-[10px] font-semibold tracking-widest">SpecKit Protocol Control</p>
                            <p class="text-[9px] mono">Task_Ledger_Hash: 0xf97316_Ref_v1.0_Active</p>
                        </div>
                        <div class="text-right space-y-1">
                            <p class="text-[10px] font-semibold tracking-widest">2026 OpenCode Infrastructure</p>
                            <p class="text-[9px] mono">End of Task Breakdown Ledger</p>
                        </div>
                    </footer>

                </main>
            </div>
        </div>
    </div>

    <script>
        function updateClock() {
            const now = new Date();
            const timeStr = now.toISOString().split('T')[1].split('.')[0] + ' UTC';
            const clockEl = document.getElementById('clock');
            if (clockEl) clockEl.textContent = timeStr;
        }
        setInterval(updateClock, 1000);
        updateClock();

        const initObservers = () => {
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                        const bars = entry.target.querySelectorAll('.viz-fill');
                        bars.forEach(bar => {
                            bar.style.width = bar.getAttribute('data-width');
                        });
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

            const navLinks = document.querySelectorAll('.toc-link');
            const sections = document.querySelectorAll('section[id]');

            const navObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        navLinks.forEach(link => {
                            link.classList.toggle('active', link.getAttribute('href') === `#${id}`);
                        });
                    }
                });
            }, { rootMargin: '-20% 0px -70% 0px' });

            sections.forEach(section => navObserver.observe(section));
        };

        window.addEventListener('DOMContentLoaded', initObservers);
    </script>
</body>
</html>