# v2.3.0.4

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**2.3.0.4**] - 2026-02-22

**Frontmatter normalization and idempotent reindex workflow finalized** - Canonical metadata formatting and migration execution were completed for templates/spec/memory markdown, followed by successful rebuild and regression verification.

> Spec folder: `.opencode/specs/003-system-spec-kit/139-hybrid-rag-fusion/004-frontmatter-indexing/` (Level 3)

---

## Highlights

### Category: Features

- **Canonical frontmatter policy enforced**: normalization and composition workflow now uses a deterministic schema for targeted markdown classes.
- **Idempotent migration gate validated**: migration apply and dry-run modes were exercised with stable second-run behavior.
- **Reindex workflow verified**: index rebuild completed with `STATUS=OK` after migration.

### Category: Verification

- **Template/build checks passed**: build and template compose verification commands passed.
- **Migration and parser suites passed**: backfill, parser, and indexing regressions were executed successfully.
- **Idempotency proof captured**: final dry-run evidence reports `changed 0 / unchanged 1789 / failed 0`.

### Category: Known Constraints

- **Legacy archive anchor warnings remain non-blocking**: archived invalid-anchor warnings were documented and intentionally not remediated in this scope.
- **Non-functional control backlog remains**: performance and formal governance controls remain tracked in the checklist.

## Files Changed

| File | Change |
|------|--------|
| `.opencode/skill/system-spec-kit/scripts/lib/frontmatter-migration.ts` | Canonical normalization/migration helpers |
| `.opencode/skill/system-spec-kit/scripts/dist/memory/backfill-frontmatter.js` | Migration CLI flow (dry-run/apply) used in execution evidence |
| `.opencode/skill/system-spec-kit/mcp_server/lib/parsing/memory-parser.ts` | Parser/compose alignment for normalized frontmatter |
| `.opencode/skill/system-spec-kit/mcp_server/tests/memory-parser.vitest.ts` | Frontmatter parsing regression coverage |
| `.opencode/skill/system-spec-kit/mcp_server/tests/spec126-full-spec-doc-indexing.vitest.ts` | Indexing regression coverage for normalized frontmatter |
| `.opencode/skill/system-spec-kit/scripts/tests/test-frontmatter-backfill.js` | Migration behavior, malformed handling, and edge-case coverage |

## Upgrade

Run migration in dry-run mode before apply for any new corpus updates, then rerun reindex. No database schema migration is required, but the migration/reindex order must remain `normalize -> verify -> rebuild` to preserve deterministic outcomes.
