# v2.2.15.0

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**2.2.15.0**] - 2026-02-15

**Spec folder level upgrade script** — New 1,490+ LOC bash script that upgrades existing spec folders between documentation levels (L1→L2, L2→L3, L3→L3+) with full user content preservation, dry-run preview, template-based generation, and idempotent operation.

> Spec folder: `specs/003-system-spec-kit/124-upgrade-level-script/` (Level 3)

---

## Highlights

### Features
- **Multi-level upgrade support** — L1→L2, L2→L3, L3→L3+, and skip-level chains (L1→L3 via sequential L1→L2 then L2→L3)
- **Dry-run mode** — Safe preview of all planned changes without modifying files (`--dry-run`)
- **Template-based file generation** — New files (checklist.md, decision-record.md) created from SpecKit addendum templates
- **Metadata and marker updates** — SPECKIT_LEVEL markers and metadata table level fields updated across all modified files
- **Idempotent operation** — Dual-pattern detection prevents duplicate sections on re-run
- **JSON output mode** — Machine-parseable output for toolchain integration (`--json`)

### Script Architecture
- **1,490+ LOC, 22 functions** — 6-phase architecture: input validation, level detection, backup creation, file upgrade, marker updates, output generation
- **Bash 3.2+ compatible** — Works on stock macOS without requiring brew-installed bash 5; no associative arrays or bashisms
- **Portable sed handling** — `_sed_inplace()` wrapper abstracts macOS vs GNU `sed -i` differences
- **Fuzzy heading matching** — Finds approximate insertion points when users have modified standard headings, with end-of-file fallback
- **Auto-cleanup** — Keeps 3 most recent backups, removes older ones automatically

## Files Changed
- `.opencode/skill/system-spec-kit/scripts/spec/upgrade-level.sh` (created, 1,490+ lines)

## Upgrade
No action required.
