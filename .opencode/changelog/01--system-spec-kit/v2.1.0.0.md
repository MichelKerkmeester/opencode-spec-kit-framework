# v2.1.0.0

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**2.1.0.0**] - 2026-02-09

**Memory index deep audit & fix** (Spec 093, Sessions 7-11) correcting the **critical FSRS formula** (factor from `19.0` to `19/81`), adding token budget observability, and removing 214 lines of dead code from vector-index.ts.

---

## Highlights

### New

- **Token budget observability** — `tokenBudget` field in response metadata for all handler responses
- **`console.error` logging** — When token budgets exceeded
- **Hint injection** — In responses when budget thresholds are hit

### Changed

- **Test suite** — 46/60 → 58/58 (100% pass rate); 2 orphan test files removed
- **vector-index.ts** — 705 → 491 lines (214 lines dead code removed)
- **12+ READMEs** — Rewritten across MCP server subdirectories
- **search-weights.json** — Cleaned dead parameters and regex patterns

### Fixed

- **CRITICAL: FSRS formula corrected** — Factor changed from `19.0` to `19/81` (~0.2346), formula from `R = (1 + t/(FACTOR*S))^(-0.5)` to `R = (1 + FACTOR*t/S)^(-0.5)`; memories were decaying ~4.5x slower than FSRS v4 standard; now R(S,S) = 0.9 as specified
- **`clearConstitutionalCache` bug** — In vector-index.ts; was calling wrong internal method
- **3 broken delegations** — In vector-index facade
- **Integration test paths** — Bug-fix tests, preflight tests
- **`safeParseJson` security alignment** — Across modules
- **5 test failures** — confidence-tracker, handler-memory-search, memory-context, tier-classifier, tool-cache

### Removed

- **Orphan `dist/core.js`** — Was shadowing `dist/core/` directory
- **9 orphaned files** — 7 dist `.js` + 2 test files
- **3 fabricated sections** — In `references/memory/memory_system.md` (decay formula, computeFingerprint(), 5-state model)
