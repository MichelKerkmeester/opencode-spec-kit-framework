# v1.1.0.0

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**1.1.0.0**] - 2025-01-29

**Major cognitive memory upgrade** implementing **FSRS power-law decay** validated on 100M+ users, **Prediction Error Gating** to prevent duplicates, and **30 bug fixes** from comprehensive 10-agent audit. Memory commands aligned with template standards.

---

## Highlights

### New

- **Cognitive Memory System**
  - **FSRS power-law algorithm** — `R(t,S) = (1 + (19/81) * t/S)^(-0.5)` replaces arbitrary exponential decay
  - **Prediction Error Gating** — 4-tier thresholds (0.95 DUPLICATE, 0.90 HIGH_MATCH, 0.70 MEDIUM_MATCH, 0.50 LOW_MATCH)
  - **5-state memory model** — HOT (>=0.8), WARM (0.25-0.8), COLD (0.05-0.25), DORMANT (0.02-0.05), ARCHIVED (<0.02)
  - **Testing Effect** — Accessing memories strengthens stability (desirable difficulty bonus)
  - **Schema v4** — New columns: stability, difficulty, last_review, review_count + memory_conflicts table

- **Files**
  - **fsrs-scheduler.js** — FSRS algorithm implementation
  - **prediction-error-gate.js** — Duplicate detection and conflict resolution
  - **fsrs-scheduler.test.js** — 30 unit tests for FSRS
  - **verify-cognitive-upgrade.js** — Comprehensive verification script

### Fixed

- **Critical Bugs (P0)**
  - **BUG-001** — FSRS function never executed; fixed signature mismatch in tier-classifier.js
  - **BUG-002** — MEDIUM_MATCH = LOW_MATCH; changed LOW_MATCH to 0.50
  - **BUG-003** — COLD = DORMANT thresholds; changed DORMANT to 0.02

- **High Bugs (P1)**
  - **BUG-004** — LRUCache missing keys() and delete() methods
  - **BUG-005** — Missing await on DB check in delete/update handlers
  - **BUG-006** — Unhandled promise rejection; wrapped reinforce_existing_memory in try/catch
  - **BUG-007** — NaN propagation; early return with 0.5 default when no timestamps
  - **BUG-008** — Data loss on restore failure; SAVEPOINT/ROLLBACK pattern in checkpoints.js
  - **BUG-009** — ReDoS in YAML regex; line-by-line parsing in memory-parser.js
  - **BUG-010** — ReDoS in trigger patterns; bounded greedy quantifiers in trigger-extractor.js
  - **BUG-011** — Silent delete errors; added console.warn logging

- **Medium Bugs (P2)**
  - **BUG-012** — Cache thundering herd; loading flag with try/finally
  - **BUG-013** — Inconsistent tier weights; centralized to importance-tiers.js
  - **BUG-014** — NaN from env vars; isNaN() validation in working-memory.js
  - **BUG-015** — Negative scores not clamped; Math.max(0, score) in co-activation.js
  - **BUG-016** — Partial transaction commits; track failures, rollback all
  - **BUG-017** — Token metrics wrong order; capture before reassignment
  - **BUG-018** — Undo doesn't check result; verify changes > 0 in history.js
  - **BUG-019** — Migration not transactional; database.transaction() wrapper
  - **BUG-020** — UTF-16 BE unsupported; manual byte-swap conversion

- **Low Bugs (P3)**
  - **BUG-021-030** — Input validation, error sanitization, Unicode boundaries, symlink detection, division guards

### Changed

- **MCP Server**
  - **Composite scoring** — Added retrievability weight (0.15), adjusted similarity (0.30 to 0.25)
  - **Tier classifier** — Extended from 3-state to 5-state model
  - **Attention decay** — Integrated FSRS decay functions

- **Memory Commands**
  - **checkpoint.md** — Template alignment: emojis, section naming
  - **database.md** — Added section number to COGNITIVE MEMORY MODEL, fixed emoji
  - **save.md** — PHASE 1B to 2 (integer numbering), emoji fixes
  - **search.md** — Numbered CONSTITUTIONAL/COGNITIVE sections
