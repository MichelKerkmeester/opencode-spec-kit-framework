# v1.0.6.0

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**1.0.6.0**] - 2026-01-21

**CORE + ADDENDUM v2.0 Architecture** — Major template architecture overhaul achieving 74-82% template line reduction through compositional model with 26 verbose templates, 557-test validation suite, and standardized 19 commands across 4 namespaces.

> Spec folder: 073-076

---

## Highlights

### CORE + ADDENDUM v2.0 Template Architecture

- **Compositional Template Model** — Monolithic templates replaced with modular core + addendum architecture
- **Core Templates** (322 LOC): spec-core.md, plan-core.md, tasks-core.md, impl-summary-core.md
- **Addendum Folders**: level2-verify (184 LOC), level3-arch (220 LOC), level3plus-govern (190 LOC)
- **Value-Based Level Scaling** — Level 1: 320 lines | Level 2: 520 lines | Level 3: 760 lines | Level 3+: 950 lines
- **Workstream Notation** — `[W-A]`, `[W-B]`, `[W-C]`, `[SYNC]` for parallel coordination (40% faster spec creation)
- **Pre-Composed Level Templates** — Ready-to-use templates in `templates/level_N/` directories
- **Architecture Decision Records** — ADR-001 (architecture), ADR-002 (value-based scaling), ADR-003 (workstream notation)

### Verbose Templates

- **26 Verbose Template Files** — Extended guidance scaffolding in `templates/verbose/` (2.5-3x longer than minimal)
- **Three Guidance Patterns** — `[YOUR_VALUE_HERE: ...]`, `[NEEDS CLARIFICATION: ...]`, `[example: ...]`
- **SPECKIT_TEMPLATE_STYLE Environment Variable** — Switch between `verbose` and `minimal` (default) templates
- **compose.sh Script** — 1,021-line automated template composition tool with `--level`, `--all`, `--dry-run` flags
- **WHEN TO USE Sections** — HTML comments for invisible guidance (visible in editing, hidden in output)

### Test Suite

- **test-template-system.js** — 95 tests for core validation, composition, markers, path resolution
- **test-validation-extended.sh** — 129 tests for 14 validation rules with exit code semantics
- **test-mcp-tools.js** — 148 tests for memory search, match_triggers, checkpoints, CRUD operations
- **test-scripts-modules.js** — 166 tests for generate-context.js, extractors, utils, lib modules
- **test-integration.js** — 36 end-to-end workflow tests (memory save, validation pipeline, cognitive flow, checkpoints)

## Changed

### Command Standardization

- **19 Commands Aligned** — Section headers standardized across 4 namespaces (spec_kit/7, memory/3, create/6, search/2)
- **Section Header Migration** — `WHAT NEXT?` → `NEXT STEPS` with removed parenthetical text
- **OUTPUT FORMATS Sections** — Added explicit documentation to 4 spec_kit commands (complete, implement, plan, research)
- **Mandatory Gate for `/memory:search`** — 33-line multi-phase blocking gate with 4 search modes
- **Frontmatter Argument Format** — Required arguments now use angle brackets (`<skill-name>`, `<agent-name>`)

### YAML Asset Updates

- **spec_kit YAMLs** — 4 files updated to v1.9.0 with Level 1 `implementation-summary.md`
- **resume YAMLs** — Anchor-based memory retrieval (~90% token efficiency): `['summary', 'state', 'next-steps']`
- **research YAMLs** — v1.9.0, 17-section enumeration
- **create_agent.yaml** — "subagent" → "secondary" terminology (9 locations), unified permission format

### Template System

- **74-82% Template Line Reduction** — Removed unused sections (Stakeholders 0%, Traceability 0%, KPI 0%, BDD 10%, Assumptions 5%)
- **Template Path Conventions** — `templates/level_N/` as canonical location (12 SKILL.md corrections)
- **implementation-summary.md Required at Level 1** — Created after implementation completes

### Infrastructure

- **Documentation Aligned to write.md Standards** — 12 files now 100% compliant (OVERVIEW rename, RELATED RESOURCES section, sequential numbering)
- **Version Bump** — system-spec-kit v1.9.0 → v2.0.0 reflecting major architectural change

## Fixed

### Template Fixes

- **Level 2 Template Composition** — Corrected composition issues where L2 templates were missing addendum sections
- **6 Orphaned COMPLEXITY_GATE Markers** — Removed from `templates/level_2/checklist.md` (deprecated markers)
- **Template Version Markers** — Added `v2.0` to SPECKIT_TEMPLATE_SOURCE in all templates

### Script Fixes

- **create.sh Uninitialized Variables** — Fixed variable initialization issues causing script failures
- **Validation Script grep Pipeline** — Added `|| true` pattern for `set -eo pipefail` compatibility
- **Non-Portable Regex** — Fixed regex patterns for cross-platform compatibility (macOS + Linux)

### Cross-Platform

- **macOS /tmp Path Security** — Added `/tmp` and `/private/tmp` to allowedBases in `data-loader.js`

### Documentation

- **Cross-Reference Fix** — `/memory:database` line 404 corrected to reference `/memory:checkpoint restore`
- **Path Reference Updates** — 36 documentation paths updated to reflect new template structure

## Files Changed

- Template system (core, addendums, verbose, level-specific directories)
- Test suite (4 new comprehensive test files, 557 total tests)
- YAML workflow configurations (spec_kit, resume, research, create_agent)
- Documentation (12 command files, 36 path references updated)
- Scripts (compose.sh, validation, data-loader.js)

## Upgrade

- **Restart Required** — Restart OpenCode to load updated templates and command definitions
- **Template Selection** — Set `SPECKIT_TEMPLATE_STYLE=verbose` for new users or `minimal` (default) for experienced
- **Compose Script** — Use `./compose.sh --all` to regenerate levels if customizing core templates
- **No Breaking Changes** — All existing spec folders and APIs maintain backward compatibility
- **Optional Migration** — Copy verbose templates to existing specs: `cp templates/verbose/level_2/* specs/###-feature/`
