# v1.2.3.0

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**1.2.3.0**] - 2026-02-05

**Ecosystem-Wide Remediation** — 3 critical bugs fixed, SQLite schema unified, gate numbering standardized, AGENTS.md naming migration across 59 files, and signal handler cleanup.

> Spec folders: `087-speckit-deep-analysis` (Level 3+) · `088-speckit-known-limitations-remediation` (Level 2)

---

## Highlights

### Critical Bug Fixes

- **`CREATE_LINKED` SQL constraint violation**: `memory_conflicts` table CHECK constraint rejected valid `CREATE_LINKED` PE decisions, silently losing conflict tracking data. Added `CREATE_LINKED` to both migration v4 schema and `create_schema()`.
- **Ghost tool references in speckit.md**: Agent tool layers table referenced 2 non-existent tools (`memory_drift_context`, `memory_drift_learn`) and showed wrong 5-layer architecture. Rewritten to correct 7-layer, 22-tool architecture.
- **Stale SKILL.md cross-references**: 5 references to renamed file corrected, plus stale section numbers fixed.

### SQLite Schema Unification

- **Three conflicting DDL schemas unified**: `memory_conflicts` table had 3 different DDL definitions with incompatible column names (`similarity_score` vs `similarity`, `notes` vs `reason`), causing both INSERT paths to silently fail.
- **Migration v12**: DROP+CREATE rebuilds `memory_conflicts` with unified 14-column schema. `SCHEMA_VERSION` bumped from 11 to 12.
- **Column renames**: `similarity_score` → `similarity`, `notes` → `reason` in `memory-save.js` and `prediction-error-gate.js`.
- **Silent error swallowing removed**: Both INSERT callers had try/catch that suppressed `no such column` errors, masking the schema mismatch. Now logs via `console.error()`.
- **`ensure_conflicts_table()` deprecated**: Converted to no-op (still exported for backward compatibility).

### Gate Numbering Standardization

- **Constitutional gate-enforcement.md**: Full gate renumbering aligned with AGENTS.md (Gate 1=Understanding, Gate 2=Skill Routing, Gate 3=Spec Folder).
- **Stale Gate 4/5/6 references removed**: Removed from 7 active files: `orchestrate.md`, `AGENTS.md`, `scripts-registry.json`, `scripts/README.md`, `check-completion.sh`, `save.md`, `INSTALL_GUIDE.md`.
- **Legacy install guide rewritten**: `SET-UP - AGENTS.md` gate section rewritten from old 7-gate scheme to current 3-gate + 3 behavioral rules.

### Signal Handler Cleanup

- **`toolCache.shutdown()`**: Added to SIGINT, SIGTERM, and uncaughtException handlers in `context-server.js`.
- **Duplicate handlers removed**: `access-tracker.js` SIGINT/SIGTERM handlers removed (now handled centrally by `context-server.js`).

### Documentation & Test Fixes

- **`schema-migration.test.js`**: Updated column names (`similarity_score` → `similarity`, `notes` → `reason`).
- **`decision-format.md`**: Gate numbers reordered to match AGENTS.md.
- **`search/README.md`**: Schema version references updated (v11 → v12).
- **`epistemic-vectors.md`**: Gate 2 → Gate 1 for dual-threshold validation reference.

### AGENTS.md Naming Migration

Standardized project instructions filename to `AGENTS.md` across the entire ecosystem. `CLAUDE.md` symlink provides Claude Code auto-load compatibility.

- **59 files**: Updated with ~218 replacements
- **Scope**: Commands, agents, skills, scripts, YAML assets, references, install guides, spec folders
- **Verification**: `grep -r "CLAUDE\.md" .opencode/` returns 0 matches

### Moderate Misalignment Fixes

- **speckit.md**: Added 4 missing `/spec_kit:*` commands (debug, handover, implement, research) + 3 undocumented scripts to Capability Scan
- **SKILL.md**: Added 3 scripts (archive.sh, check-completion.sh, recommend-level.sh) to Key Scripts
- **Template file counts**: Standardized across speckit.md, SKILL.md, README.md to match actual filesystem (L1: 5 files, L2: 6, L3: 7, L3+: 7)
- **AGENTS.md**: Added tool prefix convention note, confidence threshold clarification, two save pathways note
- **skill_advisor.py**: Boosted memory/context intent scores (now passes 0.8 threshold); reduced ambiguous "debug" boost (1.0 → 0.6)
- **opencode.json**: Documented shared-DB architecture (ADR-003)
- **Command section references**: Fixed stale section numbers in complete.md, implement.md, resume.md, research.md, plan.md

## Files Changed

41 files across `.opencode/` framework + 2 project-root files

## Upgrade
