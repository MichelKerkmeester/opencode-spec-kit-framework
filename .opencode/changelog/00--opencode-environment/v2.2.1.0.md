# v2.2.1.0

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**2.2.1.0**] - 2026-02-20

**Context overload prevention integrated into all 3 orchestrator variants** with **5 new sections** per runtime, **runtime-adapted thresholds**, and **1 retroactive spec folder** documenting the work.

---

## Highlights

### Category: Features

- **Context Pressure Response Protocol (section 7)**: 4-step sequence added to all orchestrator variants: pause dispatching, announce to user, wait for confirmation, fallback to handover. Claude uses `/compact`, Copilot/ChatGPT use "save context".
- **Output Discipline (section 7)**: Rules for summarizing large outputs, never echoing raw tool results. Threshold is >50 lines for Claude/Copilot, >80 lines for ChatGPT/Codex.
- **Orchestrator Self-Protection Rules (section 8)**: Four explicit rules prevent the orchestrator from overloading its own context: targeted reads (offset/limit on files >200/300 lines), no accumulation (3/4 file limit), write-don't-hold, batch tool calls.

### Category: Fixes

- **Recovery Protocol (section 6)**: Explicit steps for post-compaction (Claude) and post-session-degradation (Copilot/ChatGPT) recovery. Claude references CLAUDE.md + MEMORY.md, other runtimes reference AGENTS.md + project config.
- **3 new anti-patterns (section 9)**: Never bulk-read large files in main context, never echo raw output, never continue after degradation without user confirmation.

### Category: Architecture

- **Runtime-adapted thresholds**: ChatGPT/Codex (~220K context) uses higher limits than Claude/Copilot (~150K): 300 vs 200 line file reads, 4 vs 3 file accumulation, >80 vs >50 line output summarization.

### Category: Documentation

- **Spec folder 022**: Retroactive Level 2 spec folder with spec.md, plan.md, tasks.md, checklist.md, and implementation-summary.md documenting all decisions and verification results.
- **Changelog v2.0.8.0**: Agent-orchestration series changelog documenting the orchestrator improvements.

## Files Changed

- `.claude/agents/orchestrate.md` · `.opencode/agent/orchestrate.md` · `.opencode/agent/chatgpt/orchestrate.md`
- `.opencode/changelog/03--agent-orchestration/v2.0.8.0.md`
- `.opencode/specs/004-agents/022-context-overload-prevention/` (5 files)
- `.opencode/changelog/00--opencode-environment/v2.2.1.0.md`

## Upgrade

No migration required. All additions are new subsections within existing orchestrate.md files. Pull latest to activate context overload prevention guardrails across all runtimes.
