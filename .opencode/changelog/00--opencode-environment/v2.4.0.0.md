# v2.4.0.0

> Part of [OpenCode Dev Environment](https://github.com/MichelKerkmeester/opencode-spec-kit-framework)

---

## [**2.4.0.0**] - 2026-02-22

**System Spec Kit major consolidation release** -- Aggregates all features from `01--system-spec-kit` **v2.3.0.2 through v2.3.0.6**: Hybrid RAG pipeline upgrade, deterministic index/tier normalization, canonical frontmatter migration + reindex flow, auto-session detection hardening, and SpecKit Phase System rollout.

---

## Highlights

### Category: Features

- **Unified Context Engine baseline**: memory retrieval now runs tri-channel search (vector + FTS5/BM25 + graph), intent-adaptive fusion, MMR reranking, and evidence-gap signaling.
- **Deep query expansion**: deterministic synonym expansion added for `mode="deep"` retrieval flow.
- **Frontmatter standardization pipeline**: canonical schema normalization, dry-run/apply migration flow, and deterministic reindex workflow are operational.
- **SpecKit Phase System**: phase recommendation, phase-aware scaffolding (`--phase`, `--phases`, `--phase-names`), new `/spec_kit:phase` command, and recursive phase validation (`--recursive`) are now integrated.

### Category: Fixes

- **Index alias dedup fixed**: duplicate indexing from `specs/` vs `.opencode/specs/` alias roots is resolved through canonical-path dedup and unique merge enforcement.
- **Tier precedence normalized**: importance tier resolution is deterministic (`metadata -> inline marker -> default`).
- **Session auto-detection hardened**: resume/handover selection now prefers active non-archived specs, normalizes path aliases, and applies low-confidence fallback behavior.

### Category: Validation

- **Hybrid RAG regression health**: module/pipeline/integration coverage retained with latest evidence showing `4,546 passed`, `19 skipped`, `0 failed`.
- **Index/tier remediation verification**: targeted (`52`) and extended (`186`) regression suites passed with scoped lint/spec validation.
- **Frontmatter migration proof**: idempotency evidenced at `changed 0 / unchanged 1789 / failed 0` after apply + rerun.
- **Folder-detector regression**: functional suite passed (`32 passed, 0 failed, 0 skipped`) with review gate PASS.

### Category: Documentation and Status

- **Five linked component releases included**: this release rolls up all changes from system-spec-kit `v2.3.0.2` to `v2.3.0.6`.
- **Known open follow-ups retained**: PageRank/structure-aware ingest wiring and empirical latency profiling remain deferred; Phase System fixture backlog remains open (`T005`, `T028`, `T033`).

## Included Component Releases

- `.opencode/changelog/01--system-spec-kit/v2.3.0.2.md`
- `.opencode/changelog/01--system-spec-kit/v2.3.0.3.md`
- `.opencode/changelog/01--system-spec-kit/v2.3.0.4.md`
- `.opencode/changelog/01--system-spec-kit/v2.3.0.5.md`
- `.opencode/changelog/01--system-spec-kit/v2.3.0.6.md`

## Files Changed (Key Aggregate Scope)

- `.opencode/skill/system-spec-kit/mcp_server/lib/search/hybrid-search.ts`
- `.opencode/skill/system-spec-kit/mcp_server/handlers/memory-search.ts`
- `.opencode/skill/system-spec-kit/mcp_server/lib/search/mmr-reranker.ts`
- `.opencode/skill/system-spec-kit/mcp_server/lib/search/evidence-gap-detector.ts`
- `.opencode/skill/system-spec-kit/mcp_server/lib/search/query-expander.ts`
- `.opencode/skill/system-spec-kit/mcp_server/lib/manage/pagerank.ts`
- `.opencode/skill/system-spec-kit/scripts/lib/structure-aware-chunker.ts`
- `.opencode/skill/system-spec-kit/mcp_server/lib/parsing/memory-parser.ts`
- `.opencode/skill/system-spec-kit/mcp_server/handlers/memory-index.ts`
- `.opencode/skill/system-spec-kit/mcp_server/lib/scoring/importance-tiers.ts`
- `.opencode/skill/system-spec-kit/scripts/lib/frontmatter-migration.ts`
- `.opencode/skill/system-spec-kit/scripts/dist/memory/backfill-frontmatter.js`
- `.opencode/skill/system-spec-kit/scripts/spec-folder/folder-detector.ts`
- `.opencode/skill/system-spec-kit/scripts/spec/recommend-level.sh`
- `.opencode/skill/system-spec-kit/scripts/spec/create.sh`
- `.opencode/skill/system-spec-kit/scripts/spec/validate.sh`
- `.opencode/skill/system-spec-kit/scripts/rules/check-phase-links.sh`
- `.opencode/command/spec_kit/phase.md`
- `.opencode/command/spec_kit/plan.md`
- `.opencode/command/spec_kit/resume.md`
- `.opencode/command/spec_kit/handover.md`

## Upgrade

1. Pull latest changes.
2. Restart MCP services to activate retrieval/index/session-selection updates.
3. For frontmatter updates, keep using dry-run first, then apply, then reindex.
4. For phased specs, use `--recommend-phases`, `--phase`, and `validate.sh --recursive`.
5. No database schema migration is required; follow-up work remains for deferred Phase 4/fixture items noted above.
